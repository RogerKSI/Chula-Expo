<!-- Libery -->
<link rel="import" href="../../staff/bower_components/polymer/polymer.html">
<!-- Web Component -->
<link rel="import" href="../../staff/bower_components/iron-data-table/iron-data-table.html">
<link rel="import" href="../../staff/bower_components/iron-data-table/data-table-column.html">
<link rel="import" href="../ticket-api/ticket-api.html">

<dom-module id="ticket-list">
  <template>
    <ticket-api id="api" activity-id="[[activityId]]" round-id="[[roundId]]" tickets="{{tickets}}"></ticket-api>
    <iron-data-table items="[[tickets]]">
      <data-table-column name="#" width="50px" flex="0">
        <template>[[index]]</template>
      </data-table-column>
      <data-table-column name="User">
        <template>[[item.user]]</template>
      </data-table-column>
      <data-table-column name="Create">
        <template>[[_computeCreateAtDate(item.createAt)]]</template>
      </data-table-column>
      <data-table-column name="Status">
        <template>[[_computeChecked(item.checked)]]</template>
      </data-table-column>
    </iron-data-table>
  </template>
  <script>
    Polymer({
      is: 'ticket-list',
      properties: {
        _url: {
          type: String,
          value: function() {
            return window.api + '/api/'
          }
        },
        activityId: {
          type: String,
          value: ''
        },
        roundId: {
          type: String,
          value: ''
        },
        tickets: {
          type: Array,
          value: []
        },
      },
      generateRequest: function() {
        return this.$.api.generateRequest();
      },
      _computeCreateAtDate: function(createAt) {
        return moment.utc(createAt).format('D MMM, HH:mm');
      },
      _computeChecked: function(checked) {
        return checked ? 'checked' : 'unchecked';
      }
    });
  </script>
</dom-module>